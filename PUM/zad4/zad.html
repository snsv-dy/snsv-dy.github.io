<!-- 1. Proszę przygotować animację, w której wyścigówka (prostokąt z kołam) jedzie na wprost po drodze. 
Jako drogę proszę wykorzystać szary prostokąt (od góry do dołu) z białą przerywaną linią (białe prostokąty) 
na środku oraz biało czerwonymi liniami po bokach, które się przesuwają (symulując ruch). 
Sterowanie należy zrealizować za pomocą strzałek/kursorów.
2. Proszę dodać pojawiające się przeszkody, które należy omijać -->

<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
	</head>
	<body>
		<canvas width="800" height="600" style="border: 1px solid green;"></canvas>
		<script>
			var canvas = document.querySelector('canvas');
			var c = canvas.getContext('2d');

			var cw = canvas.width;
			var ch = canvas.height;
			var r = 50;
			var color = 0;
			var keys = [];

			const stripe_height = 100;
			const stripe_width = 25;
			const n_stripes = ch / stripe_height;
			var stripe_y = 0;

			const side_width = 25;
			const side_height = 35;
			const n_side_stripes = ch / side_height;
			var side_stripe_y = 0;

			const road_w = cw * 0.5;
			const road_x = (cw - road_w) / 2;

			const speed = 100;

			var car_w = 75;
			var car_h = 130;
			var carx = cw / 2;
			var cary = ch - car_h / 2 - 50;
			const car_speed = 300;

			var starttime = null;

			function frame(timestamp) {
				
				if (!starttime) {
					 starttime = timestamp;
				}

				var frameInc = (timestamp - starttime) / 1000;
				starttime = timestamp;

				handleKeys(frameInc);
				// c.clearRect(0, 0, cw, ch);
				c.beginPath();
				c.rect(0, 0, cw, ch);
				c.fillStyle = 'green';
				c.fill();

				// road
				c.beginPath();
				c.rect(road_x, 0, road_w, ch);
				c.fillStyle = 'gray';
				c.fill();

				// center line
				const stripe_x = (cw - stripe_width) / 2;
				c.fillStyle = 'white';
				for (var i = -1; i < n_stripes + 2; i += 2) {

					c.beginPath();
					c.rect(stripe_x, stripe_y + stripe_height * i, stripe_width, stripe_height);
					c.fill();
				}

				stripe_y += speed * frameInc;
				if (stripe_y > stripe_height * 2) {
					stripe_y -= stripe_height * 2;
				}

				// side lines 
				let side_x = road_x - side_width;
				for (var i = -2; i < n_side_stripes + 2; i++) {
					c.beginPath();
					c.rect(side_x, side_stripe_y + side_height * i, side_width, side_height);
					c.rect(side_x + road_w + side_width, side_stripe_y + side_height * i, side_width, side_height);
					c.fillStyle = i % 2 == 0 ? 'white' : 'red';
					c.fill();
				}

				side_stripe_y += speed * frameInc;
				if (side_stripe_y > side_height * 2) {
					side_stripe_y %= side_height * 2;
				}

				// car
				c.beginPath();
				c.rect(carx - car_w / 2, cary - (car_h / 2), car_w, car_h);
				c.fillStyle = 'lime';
				c.fill();

				// requestAnimationFrame(frame);
				setTimeout(requestAnimationFrame, 100, frame);
			}

			requestAnimationFrame(frame);

			function handleKeys(dt) {
				//d - 68
				//> - 39

				//a - 65
				//< - 37
				// const speed = car_speed;
				if ((keys[68] || keys[39])) { // prawo
					carx += car_speed * dt;
				}

				if ((keys[65] || keys[37])) { // lewo
					carx -= car_speed * dt;
				}

				if ((keys[87] || keys[38])) { // góra
					cary -= car_speed * dt;
				}

				if ((keys[83] || keys[40])) { // dół
					cary += car_speed * dt;
				}
				
				// if (keys[32] && shootDelayCount < 0) {

				// }
			}



			document.body.addEventListener('keyup', keyUp);
			document.body.addEventListener('keydown', keyDown);

			function keyUp(e) {
				keys[e.keyCode] = false;
			}

			function keyDown(e) {
				keys[e.keyCode] = true;
			}
		</script>
	</body>
</html>